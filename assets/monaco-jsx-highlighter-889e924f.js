function A(e,o){o===void 0&&(o={});var t=o.insertAt;if(!(!e||typeof document>"u")){var r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t==="top"&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}}var B=".JSXElement.JSXIdentifier{color:#4169e1}.JSXElement.JSXBracket{color:#ff8c00}.JSXElement.JSXText{color:#b8860b}.JSXElement.JSXGlyph{background:cyan;opacity:.25}.JSXClosingFragment.JSXBracket,.JSXOpeningElement.JSXBracket,.JSXOpeningFragment.JSXBracket{color:#ff8c00;font-weight:700}.JSXOpeningElement.JSXIdentifier{color:#4169e1}.JSXClosingElement.JSXBracket{color:#ff8c00;font-weight:lighter}.JSXClosingElement.JSXIdentifier{color:#4169e1;font-weight:lighter}.JSXAttribute.JSXIdentifier{color:#4682b4}.JSXExpressionContainer.JSXBracket,.JSXSpreadAttribute.JSXBracket,.JSXSpreadChild.JSXBracket{color:#ff8c00}";A(B);const I=(e,o,t={})=>{const r=[];return o(e,{...t,enter:s=>{s.type.toUpperCase().includes("JSX")&&r.push(s)}}),r},j=e=>e&&(e.key==="object"||e.key==="property"||e.key==="name"||e.key==="namespace"),w=e=>e&&e.parentPath&&e.parentPath.isJSXAttribute(),M=e=>e&&e.node&&e.node.loc,G=e=>{const o=M(e);return o?{start:{...o.start},end:{...o.end}}:null},H=e=>{const o=G(e);return o?(e.key==="object"&&e.container&&(o.end={...e.container.property.loc.start}),o):[null,null,null,null]},F=e=>{if(!M(e))return[null,null,null,null];const t=e.node.openingElement;if(!t)return[null,null,null,null];const r=t.name.name,n={start:{...t.loc.start},end:{...t.name.loc.start}},s={start:{...t.loc.end},end:{...t.loc.end}};return s.start.column--,t.selfClosing&&s.start.column--,[t,r,n,s]},P=e=>{if(!M(e))return[null,null,null,null];const t=e.node.closingElement;if(!t)return[null,null,null,null];const r=t.name&&t.name.name,n={start:{...t.loc.start},end:{...t.name.loc.start}},s={start:{...t.loc.end},end:{...t.loc.end}};return s.start.column--,[t,r,n,s]},_=e=>{const o=M(e);if(!o)return[null,null,null,null];let t=null,r=e.isJSXSpreadChild()?"expression":e.isJSXSpreadAttribute()?"argument":null,n=null;r?(t=e.node[r],n={start:{...t.loc.start},end:{...t.loc.end}},t.extra&&t.extra.parenthesized&&(n.start.column--,n.end.column++)):(n={start:{...o.start},end:{...o.end}},n.start.column++,n.end.column--);const s={start:{...o.start},end:{...n.start}},i={start:{...n.end},end:{...o.end}};return[t,r,s,i]},v="editor.action.commentLine",O=(e,o="babel")=>{switch(o){case"babel":default:return(t,r=0,n=0,s=0,i=0)=>!t||!t.start?new e.Range(1,1,1,1):new e.Range(r+t.start.line,n+t.start.column+1,s+t.end?t.end.line:t.start.line,i+t.end?t.end.column+1:t.start.column+1)}},k=(e="babel")=>{switch(e){case"babel":default:return(o,t=0,r=0,n=0,s=0)=>{const i={start:{line:0,column:0},end:{line:0,column:0}};return o&&(o.lineNumber?(i.start.line=t+o.lineNumber,i.start.column=r+o.column-1,i.end.line=n+o.lineNumber,i.end.column=s+o.column-1):(i.start.line=t+o.startLineNumber,i.start.column=r+o.startColumn-1,i.end.line=n+o.endLineNumber,i.end.column=s+o.endColumn-1)),i}}};class U{constructor(o,t,r){this.monacoEditor=o,this.monaco=t,this.loc2Range=r||k(t),this.runEditorCommentLineAction=()=>this.monacoEditor.getAction(v).run(),this.getLineIndentationColumn=n=>this.monacoEditor.getModel().getLineFirstNonWhitespaceColumn(n),this.getCommentableStartingRange=n=>{const s=this.getLineIndentationColumn(n.startLineNumber);return new this.monaco.Range(n.startLineNumber,s,n.startLineNumber,s)},this.getCommentContainingStartingRange=n=>{let s=this.getLineIndentationColumn(n.startLineNumber);return s=s?s-1:0,new this.monaco.Range(n.startLineNumber,s,n.startLineNumber,s)},this.getSelectionFirstLineText=()=>{const n=this.monacoEditor.getModel(),{startLineNumber:s}=this.monacoEditor.getSelection(),i=new this.monaco.Range(s,this.getLineIndentationColumn(s),s,n.getLineMaxColumn(s));return n.getValueInRange(i)}}}const D=(e,o={},t={})=>t.iShowHover?{...o,hoverMessage:`(${e.type})`}:o,m={ELEMENT:"ELEMENT",ALL:"ALL",IDENTIFIER:"IDENTIFIER",EDGE:"EDGE",STYLE:"STYLE"},T={[m.ELEMENT]:(e,o,t)=>{const[r,n,s,i]=F(e),c=[];r&&(c.push([s,t.isUseSeparateElementStyles?J.JSXBracket.openingElementOptions:J.JSXBracket.options]),c.push([i,t.isUseSeparateElementStyles?J.JSXBracket.openingElementOptions:J.JSXBracket.options]));const[l,,a,h]=P(e);l&&(c.push([a,t.isUseSeparateElementStyles?J.JSXBracket.closingElementOptions:J.JSXBracket.options]),c.push([h,t.isUseSeparateElementStyles?J.JSXBracket.closingElementOptions:J.JSXBracket.options]));const S=M(e);return t.isHighlightGlyph&&c.push([S,J.JSXElement.options(n)]),c},[m.ALL]:(e,o,t)=>{const r=H(e),n=[];return r&&n.push([r,D(e,o,t)]),n},[m.IDENTIFIER]:(e,o,t)=>j(e)?T[m.ALL](e,w(e)?J.JSXAttribute.options:o,t):[],[m.EDGE]:(e,o,t)=>{const r=D(e,o,t),[,,n,s]=_(e),i=[];return i.push([n,r]),i.push([s,r]),i},[m.STYLE]:()=>[]},J={JSXIdentifier:{highlightScope:m.IDENTIFIER,options:{inlineClassName:"JSXElement.JSXIdentifier"}},JSXOpeningFragment:{highlightScope:m.ALL,options:{inlineClassName:"JSXOpeningFragment.JSXBracket"}},JSXClosingFragment:{highlightScope:m.ALL,options:{inlineClassName:"JSXClosingFragment.JSXBracket"}},JSXText:{highlightScope:m.ALL,options:{inlineClassName:"JSXElement.JSXText"}},JSXExpressionContainer:{highlightScope:m.EDGE,options:{inlineClassName:"JSXExpressionContainer.JSXBracket"}},JSXSpreadChild:{highlightScope:m.EDGE,options:{inlineClassName:"JSXSpreadChild.JSXBracket"}},JSXSpreadAttribute:{highlightScope:m.EDGE,options:{inlineClassName:"JSXSpreadAttribute.JSXBracket"}},JSXElement:{highlightScope:m.ELEMENT,options:e=>({glyphMarginClassName:"JSXElement.JSXGlyph",glyphMarginHoverMessage:`JSX Element${e?": "+e:""}`})},JSXBracket:{highlightScope:m.STYLE,options:{inlineClassName:"JSXElement.JSXBracket"},openingElementOptions:{inlineClassName:"JSXOpeningElement.JSXBracket"},closingElementOptions:{inlineClassName:"JSXClosingElement.JSXBracket"}},JSXOpeningElement:{highlightScope:m.STYLE,options:{inlineClassName:"JSXOpeningElement.JSXIdentifier"}},JSXClosingElement:{highlightScope:m.STYLE,options:{inlineClassName:"JSXClosingElement.JSXIdentifier"}},JSXAttribute:{highlightScope:m.STYLE,options:{inlineClassName:"JSXAttribute.JSXIdentifier"}}};class Y{constructor(o,t,r=J){let n=[],s=[];const i=([l,a])=>n.push({range:t(l),options:a}),c=()=>(s=o.deltaDecorations(s||[],n),n=[],s);this.deltaJSXDecorations=(l,a)=>{for(const h in r)l.filter(S=>S.type===h).forEach(S=>T[r[h].highlightScope](S,r[h].options,a).forEach(f=>i(f)));return c()},this.reset=()=>{n=[],c()},this.reset()}}const y={JS:"JS",JSX:"JSX"};function K(e,o,t,r){if(!(e&&o&&t&&r))return y.JS;let n=null,s=null,i=null,c=null;return e.forEach(l=>{const a=r(l.node.loc);(l.key==="name"||l.key==="property")&&l.isJSXIdentifier()&&a.intersectRanges(o)&&(!s||s.containsRange(a))&&(s=a,c=l),a.intersectRanges(t)&&(!n||n.containsRange(a))&&(n=a,i=l)}),!i||i.isJSXExpressionContainer()||c?y.JS:y.JSX}class V{constructor(o,t){let r=null;this.getEditorCommandId=()=>r;let n=!1;this.isJSXCommentCommandActive=()=>n;const s=()=>{n=!1};this.runJsxCommentAction=(i,c)=>{const{monacoEditor:l,monaco:a,runEditorCommentLineAction:h,getSelectionFirstLineText:S}=o;if(S().match(/^\s*\/[/*]/)){h();return}const X=l.getModel();let L=!0;const x=[];for(let d=i.startLineNumber;d<=i.endLineNumber;d++){const g=new a.Range(d,X.getLineFirstNonWhitespaceColumn(d),d,X.getLineMaxColumn(d)),u=X.getValueInRange(g);x.push({commentRange:g,commentText:u}),L=L&&!!u.match(/{\/\*/)}if(c!==y.JSX&&!L){h();return}let C=[],b=0;for(let d=i.startLineNumber;d<=i.endLineNumber;d++){let{commentText:g,commentRange:u}=x[b++];L?(g=g.replace(/{\/\*/,""),g=g.replace(/\*\/}/,"")):g=`{/*${g}*/}`,C.push({identifier:{major:1,minor:1},range:u,text:g,forceMoveMarkers:!0})}C.length&&l.executeEdits(r,C)},this.addJSXCommentCommand=()=>{const{monacoEditor:i,monaco:c,loc2Range:l,runEditorCommentLineAction:a,getCommentableStartingRange:h,getCommentContainingStartingRange:S}=o;return r?(n=!0,s):(r=i.addCommand(c.KeyMod.CtrlCmd|c.KeyCode.US_SLASH,()=>{if(!n){a();return}t().then(f=>{const X=i.getSelection(),L=K(f,h(X),S(X),l);this.runJsxCommentAction(X,L)}).catch(()=>{a()})}),n=!0,i.onDidDispose(s),s)}}}const $={parser:"babel",isHighlightGlyph:!1,iShowHover:!1,isUseSeparateElementStyles:!1,jsxCommenter:null,monacoEditorManager:null,decoratorMapper:null},z=(e,o)=>()=>new Promise((t,r)=>{try{return t(e(o.getValue()))}catch(n){return r(n)}}),W=(e,o,t=I)=>()=>new Promise((r,n)=>{o().then(s=>{try{return r(t(s,e))}catch(i){return n(i)}}).catch(s=>n(s))}),q=(e,o,t,r,n={})=>{const{parserType:s,jsxCommenter:i,monacoEditorManager:c}=n,l=k(s),a=O(e,s),h=z(o,r),S=W(t,h),f=c||new U(r,e,a);return[i||new V(f,S),f,S,h,a,l]},Q=e=>(o,t={})=>e(o,{...t,sourceType:"module",plugins:["jsx"],errorRecovery:!0});class Z{constructor(o,t,r,n,s={}){this.options={...$,...s};const{jsxCommenter:i,monacoEditorManager:c,decoratorMapper:l}=this.options;this.babelParse=Q(t);const[a,h,S,f,X,L]=q(o,this.babelParse,r,n,this.options);this.jsxCommenter=i||a,this.monacoEditorManager=c||h,this.parseJSXExpressionsPromise=S,this.getAstPromise=f,this.loc2Range=X,this.range2Loc=L,this.addJSXCommentCommand=this.jsxCommenter.addJSXCommentCommand,this.decoratorMapper=l||new Y(n,this.loc2Range),this.decoratorMapperReset=()=>{l.reset()},this.highlight=(C,b=I)=>new Promise((d,g)=>{const{decoratorMapper:u,options:p}=this,N={decoratorMapper:u,options:p,ast:C,jsxExpressions:[]};if(!C)return d(N);try{const E=b(C,r);return u.deltaJSXDecorations(E,p),N.jsxExpressions=E,d(N)}catch(E){return g(E)}}),this.highlightCode=(C=u=>u,b=u=>u,d=this.getAstPromise,g=u=>u)=>d().then(u=>{this.highlight(u).then(C).catch(b)}).catch(g);let x=!1;this.isHighlightBoundToModelContentChanges=()=>x,this.highlightOnDidChangeModelContent=(C=100,b=p=>p,d=p=>p,g=this.getAstPromise,u=p=>p)=>{const p=()=>this.highlightCode(b,d,g,u);p();let N=null,E={onDidChangeModelContentDisposer:n.onDidChangeModelContent(()=>{clearTimeout(N),N=setTimeout(p,C)}),onDidChangeModelDisposer:n.onDidChangeModel(()=>{p()})};E.dispose=()=>{E.onDidChangeModelContentDisposer.dispose(),E.onDidChangeModelDisposer.dispose()},x=!0;const R=()=>{this.decoratorMapper.reset(),x&&(x=!1,E&&E.dispose(),E=null)};return n.onDidDispose(()=>{this.decoratorMapper.reset(),E=null,x=!1}),R},this.highLightOnDidChangeModelContent=this.highlightOnDidChangeModelContent}}export{v as COMMENT_ACTION_ID,T as HIGHLIGHT_MODE,m as HIGHLIGHT_TYPE,y as JSXCommentContexts,J as JSXTypes,U as MonacoEditorManager,G as cloneLoc,I as collectJSXExpressions,O as configureLoc2Range,k as configureRange2Loc,Z as default,P as extractJSXClosingElement,_ as extractJSXExpressionEdges,F as extractJSXOpeningElement,H as getCuratedLoc,K as getJSXContext,M as getLoc,j as isJSXIdentifier,w as isParentJSXAttribute,Q as makeBabelParse,z as makeGetAstPromise,q as makeJSXCommenterBundle,W as makeParseJSXExpressionsPromise,D as prepareOptions};
